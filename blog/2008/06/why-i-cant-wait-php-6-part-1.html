<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/public/stylesheets/bs.css">
    <link rel="stylesheet" href="/public/stylesheets/styles.css">
    <link rel="stylesheet" href="/public/stylesheets/pygment_trac.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet"> 
    <link rel="canonical" href="http://jamesarmes.com/blog/2008/06/why-i-cant-wait-php-6-part-1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <link rel="icon" type="image/x-icon"  href="/favicon.ico" />
    <title>Why I Can't Wait For PHP 6: Part 1 | James Armes</title>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head> 
  <body>
    <div class="wrapper">    
        <section>   
          <div id="title">
  <h1>
    
		  <a id="git-ic" href="https://github.com/jamesiarmes"><i class="fa fa-github"></i></a>
    

    
      <a id="so-ic" href="http://stackoverflow.com/users/62401/jamesarmes"><i class="fa fa-stack-overflow"></i></a>
    

    <a id="sitename" href="/">James Armes</a>
  </h1>

  <!-- Add something about you in p tag-->
  <!-- <p>Write something about you here...</p> -->
  <hr/>

  <span class="credits left">
  <a href="/blog">Blog</a> |
  <a href="/archive">Archive</a> |
  <a href="/resume">Resume</a> |
  <a href="/about">About</a>
</span>

<span class="credits right">

</span>


</div>



      
          <div class="post-title">
    <h1>Why I Can't Wait For PHP 6: Part 1</h1>
    <p class="text-muted">10 Jun 2008 | <i class="fa fa-tag"></i>
  
  
  <a class="text-muted" href="/tags/#charset">charset</a>,
  
  <a class="text-muted" href="/tags/#PHP">PHP</a>,
  
  <a class="text-muted" href="/tags/#UTF-8">UTF-8</a>
  


</p>

</div>
            
  <p>Today I decided to take the initiative to add UTF-8 support to our Item Import
and Update tools. Easier said than done. I have had my share of Unicode issues
with PHP, as I am sure everyone has. This is the first one that I have not been
able to conquer.</p>

<!--more-->

<p>Our tools use an uploaded CSV file to both import new and update existing items
in the WorkXpress application. The file can be in either a comma or tab
delimited list formats. The Unicode problem arises when the uploaded file
contains any UTF-8 characters. We use
<a href="http://us2.php.net/manual/en/function.fopen.php">fopen</a> to open the files and
<a href="http://us2.php.net/manual/en/function.fgetcsv.php">fgetcsv</a> to parse the file.
However, fgetcsv does not support UTF-8 characters. After an hour of play, I
could not get any function to read the UTF-8 characters properly, not even
<a href="http://us2.php.net/manual/en/function.file-get-contents.php">file_get_contents</a>.</p>

<p>For my test, I used a three line file I called utf_import.csv. The file looked
similar to the following:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php">"cafe Good","bold1"
"café Not So Good","bold2"
"cafae Okay I Guess","bold3"</code></pre></figure>

<p>However, I received the following results:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php">array
  0 =&gt; string 'cafe Good'
  1 =&gt; string 'bold1'

array
  0 =&gt; string 'caf� Not So Good'
  1 =&gt; string 'bold2'

array
  0 =&gt; string 'cafae Okay I Guess'
  1 =&gt; string 'bold3'</code></pre></figure>

<p>The Internet returned little help. I found several post suggesting to use
<code class="highlighter-rouge">setlocale(LC_ALL, 'en_US.UTF-8');</code> which would make sense based on this note in
the fgetcsv documentation:</p>

<blockquote>
  <p><strong>Note:</strong> Locale setting is taken into account by this function. If LANG is
e.g. en_US.UTF-8, files in one-byte encoding are read wrong by this function.</p>
</blockquote>

<p>Unfortunately, even this does not work. Some time later, I came across
<a href="http://bugs.php.net/bug.php?id=38471">PHP Bug #38471: fgetcsv(): locale dependency of delimiter / enclosure arg</a>.
The response to this bug:</p>

<blockquote>
  <p>We’re working Unicode support in PHP6. but it won’t appear in previous
versions.</p>
</blockquote>

    
<div class="share-btns">
  
 <h4>Share this post:</h4>


 
<a class="btn btn-small btn-sm twitter" href="http://twitter.com/share?text=Why I Can't Wait For PHP 6: Part 1"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>

        <a class="btn btn-small btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>

        <a class="btn btn-small btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
 </a>

</div>   

<div class="comments">
   <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jamesarmes';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

</div> 

<div class="post-footer">
  
</div>
<hr/>


  
    <div class="post-navs row">
      
        <div class="col-md-6 post-nav">
            
          <h3 class="section-header">
            Older
            <span class="text-muted"> &middot; </span>
            <a href="/archive">View Archive (33)</a>
          </h3>
            
          <h2 class="post-title-link"><a href="/blog/2008/05/browser-mightier-rich-text-area">The Browser Is Mightier Than The Rich Text Area</a></h2>
          <p>Since Firefox 3 Beta 5 was released, there has been some problems with our Rich
Text Areas in WorkXpress. The control renders but remains gray; there is no way
for users to enter text. This problem persist in Firefox 3 Release Candidate 1.</p>


        </div>
      
      
        
        <div class="col-md-6 post-nav">
          <h3 class="section-header">
            Newer
            
          </h3>
            
          <h2 class="post-title-link"><a href="/blog/2008/08/jquery-hasevent-version-100-released">JQuery hasEvent Version 1.0.0 Released</a></h2>
          <p>Today I released my first plugin for <a href="http://jquery.com/">jQuery</a>,
<a href="http://plugins.jquery.com/project/hasevent">hasEvent</a>. This plugin takes a
selector and returns true if the element contains an action on that event.</p>


        </div>
      
    </div>
  

 

          <footer>
<hr/>
  <div class="left">
    &copy;2016
    James Armes.
  </div>

  <div class="right">
    
      <a href="https://twitter.com/jamesiarmes"><i class="fa fa-twitter fa-lg" style="color:#49B1F7;"></i></a>
    </a>
    
  </div>
</footer>

        </section>
    </div>   
    </div>
    <script src="/public/javascripts/jquery.min.js"></script>
    <script src="/public/javascripts/bootstrap.min.js"></script>
    <!-- disqus comment counter -->
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jamesarmes';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function () {
	    var s = document.createElement('script'); s.async = true;
	    s.type = 'text/javascript';
	    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
	    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
	}());
</script>
<!-- /disqus comment counter -->



<!-- google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3412924-2', 'auto');
  ga('send', 'pageview');

</script>
<!-- /google analytics -->

  </body>
</html>
